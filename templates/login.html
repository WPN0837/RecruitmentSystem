<!DOCTYPE HTML>
<html>
<head>
    <script id="allmobilize" charset="utf-8" src="/static/js/allmobilize.min.js"></script>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="alternate" media="handheld"/>
    <!-- end 云适配 -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>登录-拉勾网-最专业的互联网招聘平台</title>
    <meta property="qc:admins" content="23635710066417756375"/>
    <meta content="拉勾网是3W旗下的互联网领域垂直招聘网站,互联网职业机会尽在拉勾网" name="description">
    <meta content="拉勾,拉勾网,拉勾招聘,拉钩, 拉钩网 ,互联网招聘,拉勾互联网招聘, 移动互联网招聘, 垂直互联网招聘, 微信招聘, 微博招聘, 拉勾官网, 拉勾百科,跳槽, 高薪职位, 互联网圈子, IT招聘, 职场招聘, 猎头招聘,O2O招聘, LBS招聘, 社交招聘, 校园招聘, 校招,社会招聘,社招"
          name="keywords">
    <meta name="baidu-site-verification" content="QIQ6KC1oZ6"/>
    <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="/static/css/style.css"/>
    <script src="/static/js/jquery.1.10.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/static/js/jquery.lib.min.js"></script>
    <script type="text/javascript" src="/static/js/core.min.js"></script>
    <script type="text/javascript" src="/static/js/csrf.js"></script>
</head>

<body id="login_bg">
<div class="login_wrapper">
    <div class="login_header">
        <a href="{% url 'index' %}"><img src="/static/images/logo_white.png" width="285" height="62" alt="拉勾招聘"/></a>
        <div id="cloud_s"><img src="/static/images/cloud_s.png" width="81" height="52" alt="cloud"/></div>
        <div id="cloud_m"><img src="/static/images/cloud_m.png" width="136" height="95" alt="cloud"/></div>
    </div>

    <input type="hidden" id="resubmitToken" value=""/>
    <div class="login_box">
        <form id="loginForm" action="{% url 'login' %}" method="post">
            <input type="text" id="email" name="email" value="" tabindex="1" placeholder="请输入登录邮箱地址"/>
            <input type="password" id="password" name="password" tabindex="2" placeholder="请输入密码"/>
            <span class="error" style="display:none;" id="beError"></span>
            <img id="img_code" src="{% url 'check_code' %}" onclick="get_check_code(this)">
            <input type="text" id="code" name="code" tabindex="2" placeholder="请输入验证码"/>
            <span class="error" style="display:none;" id="CodeError"></span>
            <label class="fl" for="remember">
                <input type="checkbox" id="remember" value="" checked="checked" name="autoLogin"/> 记住我
            </label>
            <a href="{% url 'reset' %}" class="fr" target="_blank">忘记密码？</a>
            <input type="hidden" id="loginToUrl" name="loginToUrl" value="{{ loginToUrl }}"/>
            <input type="submit" id="submitLogin" value="登 &nbsp; &nbsp; 录"/>
            <span class="error" style="display:none;" id="lockError"></span>

        </form>
        <div class="login_right">
            <div>还没有拉勾帐号？</div>
            <a href="{% url 'register' %}" class="registor_now">立即注册</a>

        </div>
    </div>
    <div class="login_box_btm"></div>
</div>

<script type="text/javascript">
    $(function () {
        //验证表单
        $("#loginForm").validate({
            rules: {
                email: {
                    required: true,
                    email: true
                },
                password: {
                    required: true
                },
                code: {
                    required: true
                }
            },
            messages: {
                email: {
                    required: "请输入登录邮箱地址",
                    email: "请输入有效的邮箱地址，如：vivi@lagou.com"
                },
                password: {
                    required: "请输入密码"
                }, code: {
                    required: "请输入验证码"

                }
            },
            submitHandler: function (form) {
                if ($('#remember').prop("checked")) {
                    $('#remember').val(1);
                } else {
                    $('#remember').val(null);
                }
                var email = $('#email').val();
                var password = $('#password').val();
                var remember = $('#remember').val();
                var loginToUrl = $('#loginToUrl').val();
                var code = $('#code').val();


                $(form).find(":submit").attr("disabled", true);
                $.ajax({
                    type: 'POST',
                    data: {email: email, pwd: password, autoLogin: remember, loginToUrl: loginToUrl, code: code},
                    url: '/login.html',
                    dataType: 'json',
                }).done(function (result) {
                    if (result.success === 1) {
                        if (result.content.loginToUrl) {
                            window.location.href = result.content.loginToUrl;
                        } else {
                            window.location.href = '/';
                        }
                    } else if (result.success === 0) {
                        $('#beError').text(result.msg).show();
                    } else if (result.success === 2) {
                        $('#CodeError').text(result.msg).show();
                        $('#img_code').attr('src', $('#img_code').attr('src') + '?');
                    }else if(result.success === 3){
                        $('#lockError').text(result.msg).show();
                    }
                    $(form).find(":submit").attr("disabled", false);
                });
            }
        });
    })

    function get_check_code(ths) {
        $(ths).attr('src', $(ths).attr('src') + '?');
    }
</script>
</body>
</html>