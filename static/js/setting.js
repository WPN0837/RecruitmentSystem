$(function(){$("#thirdBind_resend").click(function(){var recordCode=$("#recordCode").val();$.ajax({data:{recordCode:recordCode},type:"POST",url:"/user/resendActive.json"}).done(function(result){if(result.success){$.colorbox({inline:true,href:$("#resend_success"),title:"验证邮件发送成功"})}else{alert(result.msg)}})});var isLeave=true;window.onbeforeunload=function(){if(isLeave){return}else{return"内容还未保存，确认离开该页面吗？ "}};$("#confirmLeave").click(function(){isLeave=false});$(".user_firstMainContent").css({"padding-bottom":"10px"});$("#user_selectAccount label").not(".agreeNotice").click(function(){$(this).addClass("checked").parent("form").siblings("form").children("label").removeClass("checked");$(this).siblings("div").show();$(this).parent("form").siblings("form").children("div").hide();if($(this).siblings('div:has("ul")').length>0){$(".user_warn").hide()}else{$(".user_warn").show()}});function placeholderSupportUserBind(){return"placeholder" in document.createElement("input")}function placeholderFnUserBindFn(){if(!placeholderSupportUserBind()){$("[placeholder]").focus(function(){var input=$(this);if(input.val()==input.attr("placeholder")){input.val("");input.removeClass("placeholder");input.css("color","#333")}else{input.css("color","#333")}}).blur(function(){var input=$(this);if(input.val()==""||input.val()==input.attr("placeholder")){input.addClass("placeholder");input.val(input.attr("placeholder"));input.css("color","#999")}}).blur()}if($("[placeholder]").value===""){$("[placeholder]").value=$("[placeholder]").attr("placeholder")}}placeholderFnUserBindFn();$(".register_radio li").click(function(){$(this).children("input").attr("checked",true);$(this).siblings().children("input").removeAttr("checked");$(this).addClass("current").append("<em></em>").siblings().removeClass("current").find("em").remove();$("#user_regBindForm").validate().element($(this).find("input"))});$("#user_LoginEmail,#user_hasLoginEmail,#user_hasLoginPassword,#user_LoginPassword").focus(function(){$("#noLagouAccount_beError").hide();$("#hasLagouAccount_EmailBeError").hide();$("#hasLagouAccount_beError").hide();$("#hasNoAccount_beError").hide()});$("#user_bindForm").validate({rules:{email:{required:true,email:true},password:{required:true,rangelength:[6,16]}},messages:{email:{required:"请输入登录邮箱地址",email:"请输入有效的邮箱地址，如：email@xx.com"},password:{required:"请输入密码",rangelength:"请输入6-16位密码，字母区分大小写"}},errorPlacement:function(label,element){if(element.attr("type")=="radio"){label.insertAfter($(element).parents("ul")).css("marginTop","-20px")}else{if(element.attr("type")=="checkbox"){label.insertAfter($(element).parent()).css("clear","left");$("#user_saveRegAccount").css("margin-top","20px")}else{label.insertAfter(element)}}},submitHandler:function(form){isLeave=true;var email=$("#user_hasLoginEmail").val();var password=$("#user_hasLoginPassword").val();var type=$("#user_HasAccount").attr("value");var idCode=$("#idCode").val();$(form).find(":submit").attr("disabled",true);$.ajax({type:"post",data:{idCode:idCode,type:type,confirm:false,choseUser:1,email:email,password:password},url:"/user/bindEmail.json",dataType:"json",success:function(result){if(result.success){if(result.code==5||result.code==8||result.code==11||result.code==14){window.location.href="/user/registerSuccess.html"}else{window.location.href="/user/bindAccountActive.html?recordCode="+result.content}}else{if(result.success==false&&result.code==0){$("#hasLagouAccount_beError").html(result.msg).show()}else{if(result.success==false&&result.code==100){$("#hasLagouAccount_EmailBeError").html(result.msg).show()}else{if(result.success==false&&result.code==1){$("#accountBindType").html("邮箱");$("#user_hasBindAccount").html(result.msg);$("#user_loginCurrentAccount").html(result.content);$("#user_confirmBindTips").html("换个邮箱绑定");$.colorbox({inline:true,href:$("#bindTips"),title:"帐号绑定"});$("#user_confirmBindTips").on("click",function(){isLeave=true;$.colorbox.close();parent.jQuery.colorbox.close()})}else{if(result.success==false&&result.code==2){$.colorbox({inline:true,href:$("#bindReplace"),title:"帐号绑定"});$("#user_oldAccount").html(result.content[1]);$("#user_typeAccount").html(result.content[2]);$("#user_replaceAccount").html(result.content[3]);$("#user_resumeScore").html(result.content[0][0]["resumeStatus"]);$("#user_jobCount").html(result.content[0][0]["deliverCount"]);$("#user_publishJob").html(result.content[0][0]["publishCount"]);$("#user_receiveCount").html(result.content[0][0]["receiveCount"]);$("#user_replaceResumeScore").html(result.content[0][1]["resumeStatus"]);$("#user_replaceJobCount").html(result.content[0][1]["deliverCount"]);$("#user_replacePublishJob").html(result.content[0][1]["publishCount"]);$("#user_replaceReceiveCount").html(result.content[0][1]["receiveCount"])}}}}}$(form).find(":submit").attr("disabled",false)},error:function(){$(form).find(":submit").attr("disabled",false)}})}});var userChoose=$(".chooseAccount label");var choseUser=$(".chooseAccount label.current").find("span.c3").attr("value");
$("#user_confirmReplace").on("click",function(){var isOldChecked=$("#user_HasAccount").attr("class")=="checked";if(userChoose.hasClass("current")){$("#chooseRemainError").html("请选择需要保留的帐号").hide();$("#user_confirmReplace").attr("disabled",false);if($("#hasSidebar").val()==1){$.colorbox({inline:true,href:$("#confirmBind2"),title:"帐号绑定"})}else{if(isOldChecked){$.colorbox({inline:true,href:$("#confirmBind1"),title:"帐号绑定"})}else{$.colorbox({inline:true,href:$("#confirmBind3"),title:"帐号绑定"})}}}else{$("#chooseRemainError").html("请选择需要保留的帐号").show()}});$(".chooseAccount label em,.chooseAccount .c7").click(function(){$("#chooseRemainError").html("请选择需要保留的帐号").hide();$(this).parents("label").addClass("current").siblings("label").removeClass("current")});$(".user_backReplace").on("click",function(){$.colorbox({inline:true,href:$("#bindReplace"),title:"帐号绑定"})});$("#user_confirmBind1").on("click",function(){var email=$("#user_hasLoginEmail").val();var password=$("#user_hasLoginPassword").val();var type=$("#user_HasAccount").attr("value");var userType=$(".register_radio li.current input").val();var idCode=$("#idCode").val();var choseUser=$(".chooseAccount label.current").find("span.c3").attr("value");$.ajax({type:"post",data:{idCode:idCode,type:type,comfirm:true,choseUser:choseUser,userType:userType,email:email,password:password},url:"/user/bindEmail.json",success:function(result){isLeave=true;if(result.success){if(result.code==5||result.code==8||result.code==11||result.code==14){window.location.href="/user/registerSuccess.html"}else{window.location.href="/user/bindAccountActive.html?recordCode="+result.content}}else{if(result.msg==undefined){result=eval("("+result+")")}if(result.msg==""||result.msg==undefined||result.msg==null){alert("绑定失败")}else{if(result.msg=="页面超时，请刷新页面重新操作"){alert("你已成功点击“确认绑定”，不要重复点击哦")}else{errorTips("绑定失败："+result.msg,"帐号绑定")}}}}})});$("#user_regBindForm").validate({rules:{type:{required:true},email:{required:true,email:true},password:{required:true,rangelength:[6,16]},checkbox:{required:true}},messages:{type:{required:"请选择使用寻寻的目的"},email:{required:"请输入常用邮箱地址",email:"请输入有效的邮箱地址，如：email@xx.com"},password:{required:"请输入密码",rangelength:"请输入6-16位密码，字母区分大小写"},checkbox:{required:"请接受寻寻用户协议"}},errorPlacement:function(label,element){if(element.attr("type")=="radio"){label.insertAfter($(element).parents("ul")).css("marginTop","-20px");$(".user_registerRadio").css({"margin-top":"-10px","margin-bottom":"5px;"});$(".agreeNotice").css("margin-top","14px")}else{if(element.attr("type")=="checkbox"){label.insertAfter($(element).parent()).css("clear","left");$("#user_saveRegAccount").css("margin-top","20px")}else{label.insertAfter(element)}}},submitHandler:function(form){var email=$("#user_LoginEmail").val();var password=$("#user_LoginPassword").val();var type=$("#user_NoAccount").attr("value");var userType=$(".register_radio li.current input").val();var idCode=$("#idCode").val();$(form).find(":submit").attr("disabled",true);$.ajax({type:"post",data:{idCode:idCode,type:type,confirm:false,choseUser:1,userType:userType,email:email,password:password},url:"/user/bindEmail.json",dataType:"json",success:function(result){if(result.success){if(result.code==5||result.code==8||result.code==11||result.code==14){window.location.href="/user/registerSuccess.html"}else{window.location.href="/user/bindAccountActive.html?recordCode="+result.content}}else{if(result.success==false&&result.code==0){$("#noLagouAccount_beError").html(result.msg).show()}else{if(result.success==false&&result.code==100){}else{if(result.success==false&&result.code==1){$("#accountBindType").html("邮箱");$("#user_hasBindAccount").html(result.msg);$("#user_loginCurrentAccount").html(result.content);$("#user_confirmBindTips").html("换个邮箱绑定");$.colorbox({inline:true,href:$("#bindTips"),title:"帐号绑定"});$("#user_confirmBindTips").on("click",function(){isLeave=true;$.colorbox.close();parent.jQuery.colorbox.close()})}else{if(result.success==false&&result.code==2){$.colorbox({inline:true,href:$("#bindReplace"),title:"帐号绑定"});$("#user_oldAccount").html(result.content[1]);$("#user_typeAccount").html(result.content[2]);$("#user_replaceAccount").html(result.content[3]);$("#user_resumeScore").html(result.content[0][0]["resumeStatus"]);$("#user_jobCount").html(result.content[0][0]["deliverCount"]);$("#user_publishJob").html(result.content[0][0]["publishCount"]);$("#user_receiveCount").html(result.content[0][0]["receiveCount"]);$("#user_replaceResumeScore").html(result.content[0][1]["resumeStatus"]);$("#user_replaceJobCount").html(result.content[0][1]["deliverCount"]);$("#user_replacePublishJob").html(result.content[0][1]["publishCount"]);$("#user_replaceReceiveCount").html(result.content[0][1]["receiveCount"])}}}}}$(form).find(":submit").attr("disabled",false)},error:function(){$(form).find(":submit").attr("disabled",false)}})}});$("#newAccount_confirmBind1").click(function(){var email=$("#user_LoginEmail").val();var password=$("#user_LoginPassword").val();var type=$("#user_NoAccount").attr("value");
var userType=$(".register_radio li.current input").val();var idCode=$("#idCode").val();var choseUser=$(".chooseAccount label.current").find("span.c3").attr("value");$.ajax({type:"post",data:{idCode:idCode,type:type,comfirm:true,choseUser:choseUser,userType:userType,email:email,password:password},url:"/user/bindEmail.json",success:function(result){isLeave=true;if(result.success){if(result.code==5||result.code==8||result.code==11||result.code==14){window.location.href="/user/registerSuccess.html"}else{window.location.href="/user/bindAccountActive.html?recordCode="+result.content}}else{if(result.msg==undefined){result=eval("("+result+")")}if(result.msg==""||result.msg==undefined||result.msg==null){alert("绑定失败")}else{if(result.msg=="页面超时，请刷新页面重新操作"){alert("你已成功点击“确认绑定”，不要重复点击哦")}else{errorTips("绑定失败："+result.msg,"帐号绑定")}}}}})});$("#cancelBind").click(function(){$.colorbox({inline:true,href:$("#confirmUnbind"),title:"帐号绑定"})});$("#cancleSina").click(function(){$.colorbox({inline:true,href:$("#confirmUnbindSina"),title:"帐号绑定"})});$("#user_confirmUnbind").click(function(){window.location.href="/ologin/unbindOAuthAccount.html?origin=qq"});$("#user_confirmUnbindSina").click(function(){window.location.href="/ologin/unbindOAuthAccount.html?origin=sina"});$("#confirmUnbind .cancel,#confirmUnbindSina .cancel , #confirm_unbindService .cancel").click(function(){$.colorbox.close();parent.jQuery.colorbox.close()});$("#bindTips .btn,#bindTips .cancel").bind("click",function(){$.colorbox.close();parent.jQuery.colorbox.close()});$("#bindReplace .cancel").bind("click",function(){$("#chooseRemainError").html("请选择需要保留的帐号").hide();$.colorbox.close();parent.jQuery.colorbox.close()});$("#oldpassword").focus(function(){$("#updatePwd_beError").hide()});$("#updatePswForm").validate({rules:{oldpassword:{required:true,rangelength:[6,16]},newpassword:{required:true,rangelength:[6,16]},comfirmpassword:{required:true,equalTo:"#newpassword"}},messages:{oldpassword:{required:"请输入当前密码",rangelength:"请输入6-16位密码，字母区分大小写"},newpassword:{required:"请输入新密码",rangelength:"请输入6-16位密码，字母区分大小写"},comfirmpassword:{required:"请再次输入新密码",equalTo:"两次输入的密码不一致，请重新输入"}},submitHandler:function(form){var oldpassword=$("#oldpassword").val();var newpassword=$("#newpassword").val();var comfirmpassword=$("#comfirmpassword").val();$.ajax({url:"/update-pwd.html",type:"POST",data:{oldPassword:oldpassword,newPassword:newpassword,newPassword2:comfirmpassword,},dataType:"json"}).done(function(result){if(result.success){$.colorbox({inline:true,href:$("#updatePassword"),title:"修改密码成功"});setCountdown(4,"updatePassword h4 span","/logout.html")}else{$("#updatePwd_beError").html(result.msg).show()}})}});$(".user_confirmDel").click(function(){$.colorbox({inline:true,href:$("#confirm_unbindService"),title:"解除招聘服务"})});$("#confirm_unbind").click(function(){$.ajax({url:"/user/closeService.json",type:"POST",dataType:"json"}).done(function(result){if(result.success){$.colorbox({inline:true,href:$("#unbindService"),title:"解除招聘服务"});setCountdown(4,"unbindService h4 span","/corpCenter/bindStep1.html")}else{alert(result.msg)}})})});function setCountdown(time,id,url){var count=setTimeout(function(){$("#"+id).html(time);setCountdown(time-1,id,url)},1000);if(time==0){clearTimeout(count);top.location.href=url}};